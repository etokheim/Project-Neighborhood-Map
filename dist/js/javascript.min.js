function toggleLocationSwitcherList(){$(".location_switcher_list_container").toggleClass("location_switcher_list_container_hidden")}function scroll(e){focusedMarker(e),moveToMarker(markers()[e]),$("#swipe_list").animate({scrollLeft:$(".location_switcher_swipe_list_item")[e].offsetLeft-$(".location_switcher_swipe_list_item").eq(e).width()/2},200)}function swipeLeft(){focusedMarker()-1>=0&&focusedMarker()-1<locations().length&&scroll(focusedMarker()-1)}function swipeRight(){focusedMarker()+1>=0&&focusedMarker()+1<locations().length&&scroll(focusedMarker()+1)}function moveToMarker(e){var o={lat:e.position.lat(),lng:e.position.lng()};map.panTo(o)}function initMap(){function e(e){console.log(e),null!==e.getAnimation()?e.setAnimation(null):e.setAnimation(google.maps.Animation.BOUNCE)}function o(){for(var e=new google.maps.LatLngBounds,o=0;o<markers().length;o++)markers()[o].setMap(map),e.extend(markers()[o].position);map.fitBounds(e)}function t(e,o){e.infoWindow||(e.infoWindow=new google.maps.InfoWindow,console.log("Created new infoWindow (for marker "+e.index+") = "+e.infoWindow)),e.infoWindow.setContent('<div style="width: 200px;"><h5>'+e.title+"</h5><p>"+locations()[e.index].content.intro+"</p><p><a>Les meir</a></p></div>"),e.infoWindow.addListener("closeclick",function(){e.infoWindow.close()}),e.infoWindow.open(map,e)}console.log("creating map");var i=[{featureType:"water",stylers:[{color:"#19a0d8"}]},{featureType:"administrative",elementType:"labels.text.stroke",stylers:[{color:"#ffffff"},{weight:6}]},{featureType:"administrative",elementType:"labels.text.fill",stylers:[{color:"#e85113"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#efe9e4"},{lightness:-40}]},{featureType:"transit.station",stylers:[{weight:9},{hue:"#e85113"}]},{featureType:"road.highway",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"labels.text.stroke",stylers:[{lightness:100}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{lightness:-100}]},{featureType:"poi",elementType:"geometry",stylers:[{visibility:"on"},{color:"#f0e4d3"}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{color:"#efe9e4"},{lightness:-25}]}];map=new google.maps.Map(document.getElementById("map"),{center:{lat:40.7413549,lng:-73.9980244},zoom:13,styles:i,mapTypeControl:!1});for(var n=new google.maps.InfoWindow,l=0;l<locations().length;l++){var a=locations()[l].location,s=locations()[l].title,r=new google.maps.Marker({position:a,title:s,index:l});r.addListener("click",function(){console.log("clicked "+r),t(this,n),console.log(markers()[l-1]),e(markers()[l-1])}),markers().push(r)}o()}window.onload=function(){setTimeout(function(){toggleLocationSwitcherList()},500)};var map,markers,polygon,locations,focusedMarker,test,ViewModel=function(){markers=ko.observableArray(),polygon=null,locations=ko.observableArray([{title:"Sverd i fjell",location:{lat:58.9413738,lng:5.6713647}},{title:"Stavanger domkirke",location:{lat:58.9696008,lng:5.7327193}},{title:"KjÃ¦ragbolten",location:{lat:59.0346734,lng:6.5753282}},{title:"Preikestolen",location:{lat:58.9857634,lng:6.1575914}},{title:"Trolltunga",location:{lat:60.124167,lng:6.7378113}},{title:"Sauanuten",location:{lat:59.8274041,lng:6.3854395}},{title:"Ulriken",location:{lat:60.3774889,lng:5.3847581}}]);for(var e=0;e<locations().length;e++)locations()[e].index=e;focusedMarker=ko.observable(0),this.test=function(){scroll(this.index),toggleLocationSwitcherList()},$("#location_switcher_center").click(function(){toggleLocationSwitcherList()})};ko.applyBindings(new ViewModel);for(var locationsLength=locations().length,ajaxRunTimes=0,i=0;i<locationsLength;i++){locations()[i].content={},locations()[i].content.intro={};var response;$.ajax({url:"https://no.wikipedia.org/w/api.php?action=opensearch&search="+locations()[i].title+"&format=json&callback=wikiCallback",dataType:"jsonp",success:function(e){clearTimeout(wikipediaErrorHandling),locations()[ajaxRunTimes].content.intro=e[2][0],ajaxRunTimes++}})}var wikipediaErrorHandling=setTimeout(function(){console.log("timeout")},5e3);